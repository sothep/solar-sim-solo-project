var app=angular.module("SolarApp",["ngRoute"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/login.html",controller:"LoginController"}).when("/register",{templateUrl:"views/register.html",controller:"RegisterController"}).when("/home",{templateUrl:"views/home.html",controller:"HomeController"}).when("/create",{templateUrl:"views/create.html",controller:"CreateController"}).when("/view",{templateUrl:"views/view.html",controller:"ViewController"}).otherwise({templateUrl:"views/login.html",controller:"LoginController"}),b.html5Mode(!0)}]),app.controller("MainController",["$scope","$location","AuthentiService",function(a,b,c){a.loggedIn=function(){return c.loggedIn()},a.maxInstalls=function(){return!1},a.signOut=function(){c.signOut().then(function(a){b.path("/")})}}]),app.controller("LoginController",["$scope","$location","AuthentiService",function(a,b,c){a.user={username:"",password:""},a.badLogin=!1,a.resetFlags=function(){a.badLogin=!1},a.register=function(){b.path("/register")},a.login=function(){a.resetFlags(),c.signIn(a.user).then(function(d){console.log("server response:",d.data),"success"==d.data?(c.logIn(),b.path("/home")):a.badLogin=!0,console.log("Logged in?",c.loggedIn())},function(a){return console.log("Error: authentication failed."),!1})}}]),app.controller("RegisterController",["$scope","$location","AuthentiService",function(a,b,c){a.passwordUnmatched=!1,a.userExists=!1,a.badLogin=!1,a.user={username:"",password:""},a.passwordConfirm="";var d=function(){a.passwordUnmatched=!1,a.userExists=!1,a.badLogin=!1};a.register=function(){return d(),a.user.password!=a.passwordConfirm?void(a.passwordUnmatched=!0):void c.register(a.user).then(function(d){"success"==d.data?c.signIn(a.user).then(function(d){console.log("server response:",d.data),"success"==d.data?(c.logIn(),b.path("/home")):a.badLogin=!0,console.log("Logged in?",c.loggedIn())},function(a){return console.log("Error: authentication failed."),!1}):a.userExists=!0})}}]),app.controller("HomeController",["$scope","$location","AuthentiService",function(a,b,c){c.loggedIn()||b.path("/")}]),app.controller("ViewController",["$scope","$location","AuthentiService",function(a,b,c){c.loggedIn()||b.path("/")}]),app.controller("CreateController",["$scope","$location","AuthentiService",function(a,b,c){c.loggedIn()||b.path("/")}]),app.factory("AuthentiService",["$http",function(a){var b=!1,c=function(){return b=!1,a.get("/signout")},d=function(b){c();var d=b.username+"/"+b.password;return a.post("/auth/register/"+d)},e=function(b){return c(),console.log("userInfo:",b),a.post("/",b)},f=function(){b=!0},g=function(){return b?!0:!1};return{register:d,signIn:e,signOut:c,logIn:f,loggedIn:g}}]);